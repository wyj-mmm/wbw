"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}!function(){var e=function(e,t){this.ele=e,this.eleWidth=this.ele.offsetWidth,this.eleHeight=this.ele.offsetHeight,this.url="",this.maskLayerWidth=t.maskLayerWidth||t.maskLayerHeight||180,this.maskLayerHeight=t.maskLayerHeight||t.maskLayerWidth||180,this.backgroundScaleX=this.eleWidth/this.maskLayerWidth,this.backgroundScaleY=this.eleHeight/this.maskLayerHeight,this.scaleX=t.scale?t.scale[0]||t.scale[1]:this.backgroundScaleX,this.scaleY=t.scale?t.scale[1]||t.scale[0]:this.backgroundScaleY,this.init()};e.prototype={constructor:e,init:function(){this.ele.style.backgroundSize="100% 100%"},createRelativeBox:function(){this.maskLayer=document.createElement("div"),this.maskLayer.style.cssText="position: absolute;border: 1px solid #ccc;background: rgba(255, 255, 255, .7);cursor: move;width:"+this.maskLayerWidth+"px;height:"+this.maskLayerHeight+"px;",this.ele.appendChild(this.maskLayer),this.asideBox=document.createElement("div"),this.asideBox.style.cssText="position:absolute;left:105%;top:50%;border:2px solid #ccc;transform:translateY(-50%);width:"+this.maskLayerWidth*this.scaleX+"px;height:"+this.maskLayerHeight*this.scaleY+"px;background-image:url("+this.url+");background-repeat:no-repeat;background-size:"+100*this.backgroundScaleX+"% "+100*this.backgroundScaleY+"%",this.ele.appendChild(this.asideBox)},calcPosition:function(e){var t=e.pageX-this.ele.offsetLeft-this.maskLayerWidth/2,i=e.pageY-this.ele.offsetTop-this.maskLayerHeight/2;t<0?t=0:t>this.eleWidth-this.maskLayerWidth&&(t=this.eleWidth-this.maskLayerWidth),i<0?i=0:i>this.eleHeight-this.maskLayerHeight&&(i=this.eleHeight-this.maskLayerHeight),this.maskLayer.style.left=t+"px",this.maskLayer.style.top=i+"px",this.asideBox.style.backgroundPosition=t*-this.scaleX+"px "+i*-this.scaleY+"px"}},window.Magnifier=e}(),window.addEventListener("load",function(){!function(){var e=document.querySelector("ul.small-img-ul"),t=document.querySelector("a.phone-display"),i=0,a=!0,s={big:["../../dist/img/28cc3cbbf68a49afb3186dc8bef4c345.jpg","../../dist/img/1.jpg","../../dist/img/2.jpg","../../dist/img/3.jpg","../../dist/img/4.jpg"],small:["../../dist/img/d8a76285d9cc44abbcf313a466faf070.jpg","../../dist/img/s_1.jpg","../../dist/img/s_2.jpg","../../dist/img/s_3.jpg","../../dist/img/s_4.jpg"]},n=[];s.small.forEach(function(e){n.push("<li class='img' style='background-image:url("+e+")'></li>")}),e.innerHTML=n.join("");var r=e.children,o=r[0].offsetWidth;function l(){Array.prototype.forEach.call(r,function(e,t){e.className="img"}),r[i].className+=" active",t.style.backgroundImage="url("+s.big[i]+")"}e.style.width=r.length*o+"px",l(),e.addEventListener("mouseover",function(e){var t;t=e.target,i=Array.prototype.indexOf.call(r,t),l()});var c=new Magnifier(t,{maskLayerWidth:180,maskLayerHeight:240,scale:[2]});function d(e){a&&(c.url=s.big[i],c.createRelativeBox(),a=!1),c.calcPosition(e)}t.addEventListener("mouseenter",function(){this.addEventListener("mousemove",d,!1),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",d),this.innerHTML="",a=!0},!1)},!1);var h=document.querySelector(".btn-left"),u=document.querySelector(".btn-right"),m=(parseFloat(window.getComputedStyle(e,null).width)-parseFloat(window.getComputedStyle(e.parentNode,null).width))/o,g=0;h.addEventListener("click",function(){--g<0?g=0:e.style.left=parseFloat(window.getComputedStyle(e,null).left)+o+"px"},!1),u.addEventListener("click",function(){m<++g?g=m:e.style.left=parseFloat(window.getComputedStyle(e,null).left)-o+"px"},!1)}()});var Product=function(){function e(){_classCallCheck(this,e),this.buy=$("#buy"),this.addToCart=document.querySelector(".addToCart"),this.index=$("#index"),this.init(),this.addEvent()}return _createClass(e,[{key:"init",value:function(){var e=window.localStorage,t=e.getItem("carts")?e.getItem("carts"):"",i=convertStrToObj(t),a=0;for(var s in i)a+=i[s].num;this.buy.value="购物车(".concat(a,")")}},{key:"addEvent",value:function(){var l=this;this.buy.onclick=function(){location.href="cart.html"},this.addToCart.onclick=function(){var e=this.parentNode.parentNode.getAttribute("data-good-id"),t=this.parentNode.parentNode.firstElementChild.innerHTML,i=parseInt(this.parentNode.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.lastElementChild.firstElementChild.nextElementSibling.innerHTML),a=(this.parentNode.firstElementChild.src,window.localStorage),s=a.getItem("carts")?a.getItem("carts"):"",n=convertStrToObj(s);e in n?n[e].num++:n[e]={name:t,price:i,src:"//image8.wbiao.co/shop/28cc3cbbf68a49afb3186dc8bef4c345.jpg?x-oss-process=image/resize,w_90,h_90",num:1},a.setItem("carts",JSON.stringify(n));var r=l.buy.value,o=Number(/(\d+)/.exec(r)[1]);o++,l.index.value="".concat(o)}}}]),e}();window.onload=function(){new Product};